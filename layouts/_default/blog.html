{{ define "main" }}
<div class="blog-page">
    <header class="page-header">
        <h1 class="page-title">{{ .Title }}</h1>
        {{ with .Content }}
        <div class="page-description">{{ . }}</div>
        {{ end }}
    </header>

    <section class="blog-list">
        {{/* Get all posts, then filter by "blogs" category */}}
        {{ $allPosts := where .Site.RegularPages "Section" "post" }}
        {{ $blogPosts := slice }}
        {{ range $allPosts }}
            {{ $post := . }}
            {{ range .Params.categories }}
                {{ if eq (. | lower) "blogs" }}
                    {{ $blogPosts = $blogPosts | append $post }}
                {{ end }}
            {{ end }}
        {{ end }}

        {{ if gt (len $blogPosts) 0 }}
            {{ range $blogPosts }}
            <article class="blog-item">
                <div class="blog-item-content">
                    <span class="blog-item-date">{{ .Date.Format "January 2, 2006" }}</span>
                    <h3 class="blog-item-title">
                        <a href="{{ .Permalink }}">{{ .Title | default "Untitled" }}</a>
                    </h3>
                    <a href="{{ .Permalink }}" class="blog-item-link">Read <span>â†’</span></a>
                </div>
                {{ with .Params.photos }}
                <a href="{{ $.Permalink }}" class="blog-item-image">
                    <img src="{{ index . 0 }}" alt="{{ $.Title }}" loading="lazy">
                </a>
                {{ end }}
            </article>
            {{ end }}
        {{ else }}
            <p class="no-posts">No blog posts found.</p>
        {{ end }}
    </section>
</div>
{{ end }}
